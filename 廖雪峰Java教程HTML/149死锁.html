<div class="uk-flex-item-1" style="padding-left:15px; ">
							<div id="x-content-top">
								<!-- __snippet__.contentTop -->
																<!-- // __snippet__.contentTop -->
							</div>
							<div id="x-content">
								    <h4>&#27515;&#38145;</h4>
    <div class="x-wiki-info">
    	<span>Reads: 27231</span>
    	<a href="/manage/wiki/wikipage_update?id=1306580888846370" target="_blank" class="x-can-edit uk-text-danger">Edit</a>
</div>

    <hr>

    <div class="x-wiki-content x-main-content">
<p>Java&#30340;&#32447;&#31243;&#38145;&#26159;&#21487;&#37325;&#20837;&#30340;&#38145;&#12290;</p>
<p>&#20160;&#20040;&#26159;&#21487;&#37325;&#20837;&#30340;&#38145;&#65311;&#25105;&#20204;&#36824;&#26159;&#26469;&#30475;&#20363;&#23376;&#65306;</p>
<pre><code>public class Counter {
    private int count = 0;

    public synchronized void add(int n) {
        if (n &lt; 0) {
            dec(-n);
        } else {
            count += n;
        }
    }

    public synchronized void dec(int n) {
        count += n;
    }
}
</code></pre>
<p>&#35266;&#23519;<code>synchronized</code>&#20462;&#39280;&#30340;<code>add()</code>&#26041;&#27861;&#65292;&#19968;&#26086;&#32447;&#31243;&#25191;&#34892;&#21040;<code>add()</code>&#26041;&#27861;&#20869;&#37096;&#65292;&#35828;&#26126;&#23427;&#24050;&#32463;&#33719;&#21462;&#20102;&#24403;&#21069;&#23454;&#20363;&#30340;<code>this</code>&#38145;&#12290;&#22914;&#26524;&#20256;&#20837;&#30340;<code>n &lt; 0</code>&#65292;&#23558;&#22312;<code>add()</code>&#26041;&#27861;&#20869;&#37096;&#35843;&#29992;<code>dec()</code>&#26041;&#27861;&#12290;&#30001;&#20110;<code>dec()</code>&#26041;&#27861;&#20063;&#38656;&#35201;&#33719;&#21462;<code>this</code>&#38145;&#65292;&#29616;&#22312;&#38382;&#39064;&#26469;&#20102;&#65306;</p>
<p>&#23545;&#21516;&#19968;&#20010;&#32447;&#31243;&#65292;&#33021;&#21542;&#22312;&#33719;&#21462;&#21040;&#38145;&#20197;&#21518;&#32487;&#32493;&#33719;&#21462;&#21516;&#19968;&#20010;&#38145;&#65311;</p>
<p>&#31572;&#26696;&#26159;&#32943;&#23450;&#30340;&#12290;JVM&#20801;&#35768;&#21516;&#19968;&#20010;&#32447;&#31243;&#37325;&#22797;&#33719;&#21462;&#21516;&#19968;&#20010;&#38145;&#65292;&#36825;&#31181;&#33021;&#34987;&#21516;&#19968;&#20010;&#32447;&#31243;&#21453;&#22797;&#33719;&#21462;&#30340;&#38145;&#65292;&#23601;&#21483;&#20570;&#21487;&#37325;&#20837;&#38145;&#12290;</p>
<p>&#30001;&#20110;Java&#30340;&#32447;&#31243;&#38145;&#26159;&#21487;&#37325;&#20837;&#38145;&#65292;&#25152;&#20197;&#65292;&#33719;&#21462;&#38145;&#30340;&#26102;&#20505;&#65292;&#19981;&#20294;&#35201;&#21028;&#26029;&#26159;&#21542;&#26159;&#31532;&#19968;&#27425;&#33719;&#21462;&#65292;&#36824;&#35201;&#35760;&#24405;&#36825;&#26159;&#31532;&#20960;&#27425;&#33719;&#21462;&#12290;&#27599;&#33719;&#21462;&#19968;&#27425;&#38145;&#65292;&#35760;&#24405;+1&#65292;&#27599;&#36864;&#20986;<code>synchronized</code>&#22359;&#65292;&#35760;&#24405;-1&#65292;&#20943;&#21040;0&#30340;&#26102;&#20505;&#65292;&#25165;&#20250;&#30495;&#27491;&#37322;&#25918;&#38145;&#12290;</p>
<h3>&#27515;&#38145;</h3>
<p>&#19968;&#20010;&#32447;&#31243;&#21487;&#20197;&#33719;&#21462;&#19968;&#20010;&#38145;&#21518;&#65292;&#20877;&#32487;&#32493;&#33719;&#21462;&#21478;&#19968;&#20010;&#38145;&#12290;&#20363;&#22914;&#65306;</p>
<pre><code>public void add(int m) {
    synchronized(lockA) { // &#33719;&#24471;lockA&#30340;&#38145;
        this.value += m;
        synchronized(lockB) { // &#33719;&#24471;lockB&#30340;&#38145;
            this.another += m;
        } // &#37322;&#25918;lockB&#30340;&#38145;
    } // &#37322;&#25918;lockA&#30340;&#38145;
}

public void dec(int m) {
    synchronized(lockB) { // &#33719;&#24471;lockB&#30340;&#38145;
        this.another -= m;
        synchronized(lockA) { // &#33719;&#24471;lockA&#30340;&#38145;
            this.value -= m;
        } // &#37322;&#25918;lockA&#30340;&#38145;
    } // &#37322;&#25918;lockB&#30340;&#38145;
}
</code></pre>
<p>&#22312;&#33719;&#21462;&#22810;&#20010;&#38145;&#30340;&#26102;&#20505;&#65292;&#19981;&#21516;&#32447;&#31243;&#33719;&#21462;&#22810;&#20010;&#19981;&#21516;&#23545;&#35937;&#30340;&#38145;&#21487;&#33021;&#23548;&#33268;&#27515;&#38145;&#12290;&#23545;&#20110;&#19978;&#36848;&#20195;&#30721;&#65292;&#32447;&#31243;1&#21644;&#32447;&#31243;2&#22914;&#26524;&#20998;&#21035;&#25191;&#34892;<code>add()</code>&#21644;<code>dec()</code>&#26041;&#27861;&#26102;&#65306;</p>
<ul>
<li>&#32447;&#31243;1&#65306;&#36827;&#20837;<code>add()</code>&#65292;&#33719;&#24471;<code>lockA</code>&#65307;</li>
<li>&#32447;&#31243;2&#65306;&#36827;&#20837;<code>dec()</code>&#65292;&#33719;&#24471;<code>lockB</code>&#12290;</li>
</ul>
<p>&#38543;&#21518;&#65306;</p>
<ul>
<li>&#32447;&#31243;1&#65306;&#20934;&#22791;&#33719;&#24471;<code>lockB</code>&#65292;&#22833;&#36133;&#65292;&#31561;&#24453;&#20013;&#65307;</li>
<li>&#32447;&#31243;2&#65306;&#20934;&#22791;&#33719;&#24471;<code>lockA</code>&#65292;&#22833;&#36133;&#65292;&#31561;&#24453;&#20013;&#12290;</li>
</ul>
<p>&#27492;&#26102;&#65292;&#20004;&#20010;&#32447;&#31243;&#21508;&#33258;&#25345;&#26377;&#19981;&#21516;&#30340;&#38145;&#65292;&#28982;&#21518;&#21508;&#33258;&#35797;&#22270;&#33719;&#21462;&#23545;&#26041;&#25163;&#37324;&#30340;&#38145;&#65292;&#36896;&#25104;&#20102;&#21452;&#26041;&#26080;&#38480;&#31561;&#24453;&#19979;&#21435;&#65292;&#36825;&#23601;&#26159;&#27515;&#38145;&#12290;</p>
<p>&#27515;&#38145;&#21457;&#29983;&#21518;&#65292;&#27809;&#26377;&#20219;&#20309;&#26426;&#21046;&#33021;&#35299;&#38500;&#27515;&#38145;&#65292;&#21482;&#33021;&#24378;&#21046;&#32467;&#26463;JVM&#36827;&#31243;&#12290;</p>
<p>&#22240;&#27492;&#65292;&#22312;&#32534;&#20889;&#22810;&#32447;&#31243;&#24212;&#29992;&#26102;&#65292;&#35201;&#29305;&#21035;&#27880;&#24847;&#38450;&#27490;&#27515;&#38145;&#12290;&#22240;&#20026;&#27515;&#38145;&#19968;&#26086;&#24418;&#25104;&#65292;&#23601;&#21482;&#33021;&#24378;&#21046;&#32467;&#26463;&#36827;&#31243;&#12290;</p>
<p>&#37027;&#20040;&#25105;&#20204;&#24212;&#35813;&#22914;&#20309;&#36991;&#20813;&#27515;&#38145;&#21602;&#65311;&#31572;&#26696;&#26159;&#65306;&#32447;&#31243;&#33719;&#21462;&#38145;&#30340;&#39034;&#24207;&#35201;&#19968;&#33268;&#12290;&#21363;&#20005;&#26684;&#25353;&#29031;&#20808;&#33719;&#21462;<code>lockA</code>&#65292;&#20877;&#33719;&#21462;<code>lockB</code>&#30340;&#39034;&#24207;&#65292;&#25913;&#20889;<code>dec()</code>&#26041;&#27861;&#22914;&#19979;&#65306;</p>
<pre><code>public void dec(int m) {
    synchronized(lockA) { // &#33719;&#24471;lockA&#30340;&#38145;
        this.value -= m;
        synchronized(lockB) { // &#33719;&#24471;lockB&#30340;&#38145;
            this.another -= m;
        } // &#37322;&#25918;lockB&#30340;&#38145;
    } // &#37322;&#25918;lockA&#30340;&#38145;
}
</code></pre>
<h3>&#32451;&#20064;</h3>
<p>&#35831;&#35266;&#23519;&#27515;&#38145;&#30340;&#20195;&#30721;&#36755;&#20986;&#65292;&#28982;&#21518;&#20462;&#22797;&#12290;</p>
<p><a href="https://gitee.com/liaoxuefeng/learn-java/raw/master/practices/Java%E6%95%99%E7%A8%8B/130.%E5%A4%9A%E7%BA%BF%E7%A8%8B.1255943750561472/80.%E6%AD%BB%E9%94%81.1306580888846370/thread-deadlock.zip">&#27515;&#38145;</a></p>
<h3>&#23567;&#32467;</h3>
<p>Java&#30340;<code>synchronized</code>&#38145;&#26159;&#21487;&#37325;&#20837;&#38145;&#65307;</p>
<p>&#27515;&#38145;&#20135;&#29983;&#30340;&#26465;&#20214;&#26159;&#22810;&#32447;&#31243;&#21508;&#33258;&#25345;&#26377;&#19981;&#21516;&#30340;&#38145;&#65292;&#24182;&#20114;&#30456;&#35797;&#22270;&#33719;&#21462;&#23545;&#26041;&#24050;&#25345;&#26377;&#30340;&#38145;&#65292;&#23548;&#33268;&#26080;&#38480;&#31561;&#24453;&#65307;</p>
<p>&#36991;&#20813;&#27515;&#38145;&#30340;&#26041;&#27861;&#26159;&#22810;&#32447;&#31243;&#33719;&#21462;&#38145;&#30340;&#39034;&#24207;&#35201;&#19968;&#33268;&#12290;</p>
</div>

    <hr>

    <div class="x-wiki-prev-next uk-clearfix"></div>

    <div class="x-anchor x-comment-anchor"><a name="comments"></a></div>
							</div>
							<div id="x-content-bottom">
								<!-- __snippet__.contentBottom -->
								<div id="sponsor-a" class="uk-margin-bottom"></div>
								<!-- // __snippet__.contentBottom -->
							</div>
							<div id="x-content-comment">
								    <h3>Comments</h3>

    <ul id="x-comment-list" class="uk-comment-list">
    </ul>

    <h3>Make a comment</h3>

    <div class="x-display-if-not-signin">
        <p><button type="button" class="uk-button" onclick="showSignin()"><i class="uk-icon-signin"></i> Sign in to make a comment</button></p>
    </div>

    <div id="x-comment-area"></div>

							</div>
						</div>
											
