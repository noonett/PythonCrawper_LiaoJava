<div class="uk-flex-item-1" style="padding-left:15px; ">
							<div id="x-content-top">
								<!-- __snippet__.contentTop -->
																<!-- // __snippet__.contentTop -->
							</div>
							<div id="x-content">
								    <h4>&#23494;&#38053;&#20132;&#25442;&#31639;&#27861;</h4>
    <div class="x-wiki-info">
    	<span>Reads: 14690</span>
    	<a href="/manage/wiki/wikipage_update?id=1304227905273889" target="_blank" class="x-can-edit uk-text-danger">Edit</a>
</div>

    <hr>

    <div class="x-wiki-content x-main-content">
<p>&#23545;&#31216;&#21152;&#23494;&#31639;&#27861;&#35299;&#20915;&#20102;&#25968;&#25454;&#21152;&#23494;&#30340;&#38382;&#39064;&#12290;&#25105;&#20204;&#20197;AES&#21152;&#23494;&#20026;&#20363;&#65292;&#22312;&#29616;&#23454;&#19990;&#30028;&#20013;&#65292;&#23567;&#26126;&#35201;&#21521;&#36335;&#20154;&#30002;&#21457;&#36865;&#19968;&#20010;&#21152;&#23494;&#25991;&#20214;&#65292;&#20182;&#21487;&#20197;&#20808;&#29983;&#25104;&#19968;&#20010;AES&#23494;&#38053;&#65292;&#23545;&#25991;&#20214;&#36827;&#34892;&#21152;&#23494;&#65292;&#28982;&#21518;&#25226;&#21152;&#23494;&#25991;&#20214;&#21457;&#36865;&#32473;&#23545;&#26041;&#12290;&#22240;&#20026;&#23545;&#26041;&#35201;&#35299;&#23494;&#65292;&#23601;&#24517;&#39035;&#38656;&#35201;&#23567;&#26126;&#29983;&#25104;&#30340;&#23494;&#38053;&#12290;</p>
<p>&#29616;&#22312;&#38382;&#39064;&#26469;&#20102;&#65306;&#22914;&#20309;&#20256;&#36882;&#23494;&#38053;&#65311;</p>
<p>&#22312;&#19981;&#23433;&#20840;&#30340;&#20449;&#36947;&#19978;&#20256;&#36882;&#21152;&#23494;&#25991;&#20214;&#26159;&#27809;&#26377;&#38382;&#39064;&#30340;&#65292;&#22240;&#20026;&#40657;&#23458;&#25343;&#21040;&#21152;&#23494;&#25991;&#20214;&#27809;&#26377;&#29992;&#12290;&#20294;&#26159;&#65292;&#22914;&#20309;&#22914;&#20309;&#22312;&#19981;&#23433;&#20840;&#30340;&#20449;&#36947;&#19978;&#23433;&#20840;&#22320;&#20256;&#36755;&#23494;&#38053;&#65311;</p>
<p>&#35201;&#35299;&#20915;&#36825;&#20010;&#38382;&#39064;&#65292;&#23494;&#38053;&#20132;&#25442;&#31639;&#27861;&#21363;DH&#31639;&#27861;&#65306;Diffie-Hellman&#31639;&#27861;&#24212;&#36816;&#32780;&#29983;&#12290;</p>
<p>DH&#31639;&#27861;&#35299;&#20915;&#20102;&#23494;&#38053;&#22312;&#21452;&#26041;&#19981;&#30452;&#25509;&#20256;&#36882;&#23494;&#38053;&#30340;&#24773;&#20917;&#19979;&#23436;&#25104;&#23494;&#38053;&#20132;&#25442;&#65292;&#36825;&#20010;&#31070;&#22855;&#30340;&#20132;&#25442;&#21407;&#29702;&#23436;&#20840;&#30001;&#25968;&#23398;&#29702;&#35770;&#25903;&#25345;&#12290;</p>
<p>&#25105;&#20204;&#26469;&#30475;DH&#31639;&#27861;&#20132;&#25442;&#23494;&#38053;&#30340;&#27493;&#39588;&#12290;&#20551;&#35774;&#30002;&#20057;&#21452;&#26041;&#38656;&#35201;&#20256;&#36882;&#23494;&#38053;&#65292;&#20182;&#20204;&#20043;&#38388;&#21487;&#20197;&#36825;&#20040;&#20570;&#65306;</p>
<ol>
<li>&#30002;&#39318;&#36873;&#36873;&#25321;&#19968;&#20010;&#32032;&#25968;<code>p</code>&#65292;&#20363;&#22914;509&#65292;&#24213;&#25968;<code>g</code>&#65292;&#20219;&#36873;&#65292;&#20363;&#22914;5&#65292;&#38543;&#26426;&#25968;<code>a</code>&#65292;&#20363;&#22914;123&#65292;&#28982;&#21518;&#35745;&#31639;<code>A=g^a mod p</code>&#65292;&#32467;&#26524;&#26159;215&#65292;&#28982;&#21518;&#65292;&#30002;&#21457;&#36865;<code>p&#65309;509</code>&#65292;<code>g=5</code>&#65292;<code>A=215</code>&#32473;&#20057;&#65307;</li>
<li>&#20057;&#26041;&#25910;&#21040;&#21518;&#65292;&#20063;&#36873;&#25321;&#19968;&#20010;&#38543;&#26426;&#25968;<code>b</code>&#65292;&#20363;&#22914;&#65292;456&#65292;&#28982;&#21518;&#35745;&#31639;<code>B=g^b mod p</code>&#65292;&#32467;&#26524;&#26159;181&#65292;&#20057;&#20877;&#21516;&#26102;&#35745;&#31639;<code>s=A^b mod p</code>&#65292;&#32467;&#26524;&#26159;121&#65307;</li>
<li>&#20057;&#25226;&#35745;&#31639;&#30340;<code>B=181</code>&#21457;&#32473;&#30002;&#65292;&#30002;&#35745;&#31639;<code>s&#65309;B^a mod p</code>&#30340;&#20313;&#25968;&#65292;&#35745;&#31639;&#32467;&#26524;&#19982;&#20057;&#31639;&#20986;&#30340;&#32467;&#26524;&#19968;&#26679;&#65292;&#37117;&#26159;121&#12290;</li>
</ol>
<p>&#25152;&#20197;&#26368;&#32456;&#21452;&#26041;&#21327;&#21830;&#20986;&#30340;&#23494;&#38053;<code>s</code>&#26159;121&#12290;&#27880;&#24847;&#21040;&#36825;&#20010;&#23494;&#38053;<code>s</code>&#24182;&#27809;&#26377;&#22312;&#32593;&#32476;&#19978;&#20256;&#36755;&#12290;&#32780;&#36890;&#36807;&#32593;&#32476;&#20256;&#36755;&#30340;<code>p</code>&#65292;<code>g</code>&#65292;<code>A</code>&#21644;<code>B</code>&#26159;&#26080;&#27861;&#25512;&#31639;&#20986;<code>s</code>&#30340;&#65292;&#22240;&#20026;&#23454;&#38469;&#31639;&#27861;&#36873;&#25321;&#30340;&#32032;&#25968;&#26159;&#38750;&#24120;&#22823;&#30340;&#12290;</p>
<p>&#25152;&#20197;&#65292;&#26356;&#30830;&#20999;&#22320;&#35828;&#65292;DH&#31639;&#27861;&#26159;&#19968;&#20010;&#23494;&#38053;&#21327;&#21830;&#31639;&#27861;&#65292;&#21452;&#26041;&#26368;&#32456;&#21327;&#21830;&#20986;&#19968;&#20010;&#20849;&#21516;&#30340;&#23494;&#38053;&#65292;&#32780;&#36825;&#20010;&#23494;&#38053;&#19981;&#20250;&#36890;&#36807;&#32593;&#32476;&#20256;&#36755;&#12290;</p>
<p>&#22914;&#26524;&#25105;&#20204;&#25226;<code>a</code>&#30475;&#25104;&#30002;&#30340;&#31169;&#38053;&#65292;<code>A</code>&#30475;&#25104;&#30002;&#30340;&#20844;&#38053;&#65292;<code>b</code>&#30475;&#25104;&#20057;&#30340;&#31169;&#38053;&#65292;<code>B</code>&#30475;&#25104;&#20057;&#30340;&#20844;&#38053;&#65292;DH&#31639;&#27861;&#30340;&#26412;&#36136;&#23601;&#26159;&#21452;&#26041;&#21508;&#33258;&#29983;&#25104;&#33258;&#24049;&#30340;&#31169;&#38053;&#21644;&#20844;&#38053;&#65292;&#31169;&#38053;&#20165;&#23545;&#33258;&#24049;&#21487;&#35265;&#65292;&#28982;&#21518;&#20132;&#25442;&#20844;&#38053;&#65292;&#24182;&#26681;&#25454;&#33258;&#24049;&#30340;&#31169;&#38053;&#21644;&#23545;&#26041;&#30340;&#20844;&#38053;&#65292;&#29983;&#25104;&#26368;&#32456;&#30340;&#23494;&#38053;<code>secretKey</code>&#65292;DH&#31639;&#27861;&#36890;&#36807;&#25968;&#23398;&#23450;&#24459;&#20445;&#35777;&#20102;&#21452;&#26041;&#21508;&#33258;&#35745;&#31639;&#20986;&#30340;<code>secretKey</code>&#26159;&#30456;&#21516;&#30340;&#12290;</p>
<p>&#20351;&#29992;Java&#23454;&#29616;DH&#31639;&#27861;&#30340;&#20195;&#30721;&#22914;&#19979;&#65306;</p>
<pre><code class="language-x-java">import java.math.BigInteger;
import java.security.*;
import java.security.spec.*;

import javax.crypto.KeyAgreement;
----
public class Main {
    public static void main(String[] args) {
        // Bob&#21644;Alice:
        Person bob = new Person("Bob");
        Person alice = new Person("Alice");

        // &#21508;&#33258;&#29983;&#25104;KeyPair:
        bob.generateKeyPair();
        alice.generateKeyPair();

        // &#21452;&#26041;&#20132;&#25442;&#21508;&#33258;&#30340;PublicKey:
        // Bob&#26681;&#25454;Alice&#30340;PublicKey&#29983;&#25104;&#33258;&#24049;&#30340;&#26412;&#22320;&#23494;&#38053;:
        bob.generateSecretKey(alice.publicKey.getEncoded());
        // Alice&#26681;&#25454;Bob&#30340;PublicKey&#29983;&#25104;&#33258;&#24049;&#30340;&#26412;&#22320;&#23494;&#38053;:
        alice.generateSecretKey(bob.publicKey.getEncoded());

        // &#26816;&#26597;&#21452;&#26041;&#30340;&#26412;&#22320;&#23494;&#38053;&#26159;&#21542;&#30456;&#21516;:
        bob.printKeys();
        alice.printKeys();
        // &#21452;&#26041;&#30340;SecretKey&#30456;&#21516;&#65292;&#21518;&#32493;&#36890;&#20449;&#23558;&#20351;&#29992;SecretKey&#20316;&#20026;&#23494;&#38053;&#36827;&#34892;AES&#21152;&#35299;&#23494;...
    }
}

class Person {
    public final String name;

    public PublicKey publicKey;
    private PrivateKey privateKey;
    private byte[] secretKey;

    public Person(String name) {
        this.name = name;
    }

    // &#29983;&#25104;&#26412;&#22320;KeyPair:
    public void generateKeyPair() {
        try {
            KeyPairGenerator kpGen = KeyPairGenerator.getInstance("DH");
            kpGen.initialize(512);
            KeyPair kp = kpGen.generateKeyPair();
            this.privateKey = kp.getPrivate();
            this.publicKey = kp.getPublic();
        } catch (GeneralSecurityException e) {
            throw new RuntimeException(e);
        }
    }

    public void generateSecretKey(byte[] receivedPubKeyBytes) {
        try {
            // &#20174;byte[]&#24674;&#22797;PublicKey:
            X509EncodedKeySpec keySpec = new X509EncodedKeySpec(receivedPubKeyBytes);
            KeyFactory kf = KeyFactory.getInstance("DH");
            PublicKey receivedPublicKey = kf.generatePublic(keySpec);
            // &#29983;&#25104;&#26412;&#22320;&#23494;&#38053;:
            KeyAgreement keyAgreement = KeyAgreement.getInstance("DH");
            keyAgreement.init(this.privateKey); // &#33258;&#24049;&#30340;PrivateKey
            keyAgreement.doPhase(receivedPublicKey, true); // &#23545;&#26041;&#30340;PublicKey
            // &#29983;&#25104;SecretKey&#23494;&#38053;:
            this.secretKey = keyAgreement.generateSecret();
        } catch (GeneralSecurityException e) {
            throw new RuntimeException(e);
        }
    }

    public void printKeys() {
        System.out.printf("Name: %s\n", this.name);
        System.out.printf("Private key: %x\n", new BigInteger(1, this.privateKey.getEncoded()));
        System.out.printf("Public key: %x\n", new BigInteger(1, this.publicKey.getEncoded()));
        System.out.printf("Secret key: %x\n", new BigInteger(1, this.secretKey));
    }
}
</code></pre>
<p>&#20294;&#26159;DH&#31639;&#27861;&#24182;&#26410;&#35299;&#20915;&#20013;&#38388;&#20154;&#25915;&#20987;&#65292;&#21363;&#30002;&#20057;&#21452;&#26041;&#24182;&#19981;&#33021;&#30830;&#20445;&#19982;&#33258;&#24049;&#36890;&#20449;&#30340;&#26159;&#21542;&#30495;&#30340;&#26159;&#23545;&#26041;&#12290;&#28040;&#38500;&#20013;&#38388;&#20154;&#25915;&#20987;&#38656;&#35201;&#20854;&#20182;&#26041;&#27861;&#12290;</p>
<h3>&#32451;&#20064;</h3>
<p><a href="https://gitee.com/liaoxuefeng/learn-java/raw/master/practices/Java%E6%95%99%E7%A8%8B/120.%E5%8A%A0%E5%AF%86%E4%B8%8E%E5%AE%89%E5%85%A8.1255943717668160/70.%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E7%AE%97%E6%B3%95.1304227905273889/encrypt-dh.zip">&#23494;&#38053;&#20132;&#25442;&#31639;&#27861;</a></p>
<h3>&#23567;&#32467;</h3>
<p>DH&#31639;&#27861;&#26159;&#19968;&#31181;&#23494;&#38053;&#20132;&#25442;&#21327;&#35758;&#65292;&#36890;&#20449;&#21452;&#26041;&#36890;&#36807;&#19981;&#23433;&#20840;&#30340;&#20449;&#36947;&#21327;&#21830;&#23494;&#38053;&#65292;&#28982;&#21518;&#36827;&#34892;&#23545;&#31216;&#21152;&#23494;&#20256;&#36755;&#12290;</p>
<p>DH&#31639;&#27861;&#27809;&#26377;&#35299;&#20915;&#20013;&#38388;&#20154;&#25915;&#20987;&#12290;</p>
</div>

    <hr>

    <div class="x-wiki-prev-next uk-clearfix"></div>

    <div class="x-anchor x-comment-anchor"><a name="comments"></a></div>
							</div>
							<div id="x-content-bottom">
								<!-- __snippet__.contentBottom -->
								<div id="sponsor-a" class="uk-margin-bottom"></div>
								<!-- // __snippet__.contentBottom -->
							</div>
							<div id="x-content-comment">
								    <h3>Comments</h3>

    <ul id="x-comment-list" class="uk-comment-list">
    </ul>

    <h3>Make a comment</h3>

    <div class="x-display-if-not-signin">
        <p><button type="button" class="uk-button" onclick="showSignin()"><i class="uk-icon-signin"></i> Sign in to make a comment</button></p>
    </div>

    <div id="x-comment-area"></div>

							</div>
						</div>
											
