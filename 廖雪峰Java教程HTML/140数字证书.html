<div class="uk-flex-item-1" style="padding-left:15px; ">
							<div id="x-content-top">
								<!-- __snippet__.contentTop -->
																<!-- // __snippet__.contentTop -->
							</div>
							<div id="x-content">
								    <h4>&#25968;&#23383;&#35777;&#20070;</h4>
    <div class="x-wiki-info">
    	<span>Reads: 14455</span>
    	<a href="/manage/wiki/wikipage_update?id=1304227968188450" target="_blank" class="x-can-edit uk-text-danger">Edit</a>
</div>

    <hr>

    <div class="x-wiki-content x-main-content">
<p>&#25105;&#20204;&#30693;&#36947;&#65292;&#25688;&#35201;&#31639;&#27861;&#29992;&#26469;&#30830;&#20445;&#25968;&#25454;&#27809;&#26377;&#34987;&#31713;&#25913;&#65292;&#38750;&#23545;&#31216;&#21152;&#23494;&#31639;&#27861;&#21487;&#20197;&#23545;&#25968;&#25454;&#36827;&#34892;&#21152;&#35299;&#23494;&#65292;&#31614;&#21517;&#31639;&#27861;&#21487;&#20197;&#30830;&#20445;&#25968;&#25454;&#23436;&#25972;&#24615;&#21644;&#25239;&#21542;&#35748;&#24615;&#65292;&#25226;&#36825;&#20123;&#31639;&#27861;&#38598;&#21512;&#21040;&#19968;&#36215;&#65292;&#24182;&#25630;&#19968;&#22871;&#23436;&#21892;&#30340;&#26631;&#20934;&#65292;&#36825;&#23601;&#26159;&#25968;&#23383;&#35777;&#20070;&#12290;</p>
<p>&#22240;&#27492;&#65292;&#25968;&#23383;&#35777;&#20070;&#23601;&#26159;&#38598;&#21512;&#20102;&#22810;&#31181;&#23494;&#30721;&#23398;&#31639;&#27861;&#65292;&#29992;&#20110;&#23454;&#29616;&#25968;&#25454;&#21152;&#35299;&#23494;&#12289;&#36523;&#20221;&#35748;&#35777;&#12289;&#31614;&#21517;&#31561;&#22810;&#31181;&#21151;&#33021;&#30340;&#19968;&#31181;&#23433;&#20840;&#26631;&#20934;&#12290;</p>
<p>&#25968;&#23383;&#35777;&#20070;&#21487;&#20197;&#38450;&#27490;&#20013;&#38388;&#20154;&#25915;&#20987;&#65292;&#22240;&#20026;&#23427;&#37319;&#29992;&#38142;&#24335;&#31614;&#21517;&#35748;&#35777;&#65292;&#21363;&#36890;&#36807;&#26681;&#35777;&#20070;&#65288;Root CA&#65289;&#21435;&#31614;&#21517;&#19979;&#19968;&#32423;&#35777;&#20070;&#65292;&#36825;&#26679;&#23618;&#23618;&#31614;&#21517;&#65292;&#30452;&#21040;&#26368;&#32456;&#30340;&#29992;&#25143;&#35777;&#20070;&#12290;&#32780;Root CA&#35777;&#20070;&#20869;&#32622;&#20110;&#25805;&#20316;&#31995;&#32479;&#20013;&#65292;&#25152;&#20197;&#65292;&#20219;&#20309;&#32463;&#36807;CA&#35748;&#35777;&#30340;&#25968;&#23383;&#35777;&#20070;&#37117;&#21487;&#20197;&#23545;&#20854;&#26412;&#36523;&#36827;&#34892;&#26657;&#39564;&#65292;&#30830;&#20445;&#35777;&#20070;&#26412;&#36523;&#19981;&#26159;&#20266;&#36896;&#30340;&#12290;</p>
<p>&#25105;&#20204;&#22312;&#19978;&#32593;&#26102;&#24120;&#29992;&#30340;HTTPS&#21327;&#35758;&#23601;&#26159;&#25968;&#23383;&#35777;&#20070;&#30340;&#24212;&#29992;&#12290;&#27983;&#35272;&#22120;&#20250;&#33258;&#21160;&#39564;&#35777;&#35777;&#20070;&#30340;&#26377;&#25928;&#24615;&#65306;</p>
<p><img src="/static/img/loading.svg" data-src="/files/attachments/1311504758472770/l" alt="cert"></p>
<p>&#35201;&#20351;&#29992;&#25968;&#23383;&#35777;&#20070;&#65292;&#39318;&#20808;&#38656;&#35201;&#21019;&#24314;&#35777;&#20070;&#12290;&#27491;&#24120;&#24773;&#20917;&#19979;&#65292;&#19968;&#20010;&#21512;&#27861;&#30340;&#25968;&#23383;&#35777;&#20070;&#38656;&#35201;&#32463;&#36807;CA&#31614;&#21517;&#65292;&#36825;&#38656;&#35201;&#35748;&#35777;&#22495;&#21517;&#24182;&#25903;&#20184;&#19968;&#23450;&#30340;&#36153;&#29992;&#12290;&#24320;&#21457;&#30340;&#26102;&#20505;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;&#33258;&#31614;&#21517;&#30340;&#35777;&#20070;&#65292;&#36825;&#31181;&#35777;&#20070;&#21487;&#20197;&#27491;&#24120;&#24320;&#21457;&#35843;&#35797;&#65292;&#20294;&#19981;&#33021;&#23545;&#22806;&#20316;&#20026;&#26381;&#21153;&#20351;&#29992;&#65292;&#22240;&#20026;&#20854;&#20182;&#23458;&#25143;&#31471;&#24182;&#19981;&#35748;&#21487;&#26410;&#32463;CA&#31614;&#21517;&#30340;&#35777;&#20070;&#12290;</p>
<p>&#22312;Java&#31243;&#24207;&#20013;&#65292;&#25968;&#23383;&#35777;&#20070;&#23384;&#20648;&#22312;&#19968;&#31181;Java&#19987;&#29992;&#30340;key store&#25991;&#20214;&#20013;&#65292;JDK&#25552;&#20379;&#20102;&#19968;&#31995;&#21015;&#21629;&#20196;&#26469;&#21019;&#24314;&#21644;&#31649;&#29702;key store&#12290;&#25105;&#20204;&#29992;&#19979;&#38754;&#30340;&#21629;&#20196;&#21019;&#24314;&#19968;&#20010;key store&#65292;&#24182;&#35774;&#23450;&#21475;&#20196;123456&#65306;</p>
<pre><code>keytool -storepass 123456 -genkeypair -keyalg RSA -keysize 1024 -sigalg SHA1withRSA -validity 3650 -alias mycert -keystore my.keystore -dname "CN=www.sample.com, OU=sample, O=sample, L=BJ, ST=BJ, C=CN"
</code></pre>
<p>&#20960;&#20010;&#20027;&#35201;&#30340;&#21442;&#25968;&#26159;&#65306;</p>
<ul>
<li>keyalg&#65306;&#25351;&#23450;RSA&#21152;&#23494;&#31639;&#27861;&#65307;</li>
<li>sigalg&#65306;&#25351;&#23450;SHA1withRSA&#31614;&#21517;&#31639;&#27861;&#65307;</li>
<li>validity&#65306;&#25351;&#23450;&#35777;&#20070;&#26377;&#25928;&#26399;3650&#22825;&#65307;</li>
<li>alias&#65306;&#25351;&#23450;&#35777;&#20070;&#22312;&#31243;&#24207;&#20013;&#24341;&#29992;&#30340;&#21517;&#31216;&#65307;</li>
<li>dname&#65306;&#26368;&#37325;&#35201;&#30340;<code>CN=www.sample.com</code>&#25351;&#23450;&#20102;<code>Common Name</code>&#65292;&#22914;&#26524;&#35777;&#20070;&#29992;&#22312;HTTPS&#20013;&#65292;&#36825;&#20010;&#21517;&#31216;&#24517;&#39035;&#19982;&#22495;&#21517;&#23436;&#20840;&#19968;&#33268;&#12290;</li>
</ul>
<p>&#25191;&#34892;&#19978;&#36848;&#21629;&#20196;&#65292;JDK&#20250;&#22312;&#24403;&#21069;&#30446;&#24405;&#21019;&#24314;&#19968;&#20010;<code>my.keystore</code>&#25991;&#20214;&#65292;&#24182;&#23384;&#20648;&#21019;&#24314;&#25104;&#21151;&#30340;&#19968;&#20010;&#31169;&#38053;&#21644;&#19968;&#20010;&#35777;&#20070;&#65292;&#23427;&#30340;&#21035;&#21517;&#26159;<code>mycert</code>&#12290;</p>
<p>&#26377;&#20102;key store&#23384;&#20648;&#30340;&#35777;&#20070;&#65292;&#25105;&#20204;&#23601;&#21487;&#20197;&#36890;&#36807;&#25968;&#23383;&#35777;&#20070;&#36827;&#34892;&#21152;&#35299;&#23494;&#21644;&#31614;&#21517;&#65306;</p>
<pre><code class="language-java">import java.io.InputStream;
import java.math.BigInteger;
import java.security.*;
import java.security.cert.*;
import javax.crypto.Cipher;

public class Main {
    public static void main(String[] args) throws Exception {
        byte[] message = "Hello, use X.509 cert!".getBytes("UTF-8");
        // &#35835;&#21462;KeyStore:
        KeyStore ks = loadKeyStore("/my.keystore", "123456");
        // &#35835;&#21462;&#31169;&#38053;:
        PrivateKey privateKey = (PrivateKey) ks.getKey("mycert", "123456".toCharArray());
        // &#35835;&#21462;&#35777;&#20070;:
        X509Certificate certificate = (X509Certificate) ks.getCertificate("mycert");
        // &#21152;&#23494;:
        byte[] encrypted = encrypt(certificate, message);
        System.out.println(String.format("encrypted: %x", new BigInteger(1, encrypted)));
        // &#35299;&#23494;:
        byte[] decrypted = decrypt(privateKey, encrypted);
        System.out.println("decrypted: " + new String(decrypted, "UTF-8"));
        // &#31614;&#21517;:
        byte[] sign = sign(privateKey, certificate, message);
        System.out.println(String.format("signature: %x", new BigInteger(1, sign)));
        // &#39564;&#35777;&#31614;&#21517;:
        boolean verified = verify(certificate, message, sign);
        System.out.println("verify: " + verified);
    }

    static KeyStore loadKeyStore(String keyStoreFile, String password) {
        try (InputStream input = Main.class.getResourceAsStream(keyStoreFile)) {
            if (input == null) {
                throw new RuntimeException("file not found in classpath: " + keyStoreFile);
            }
            KeyStore ks = KeyStore.getInstance(KeyStore.getDefaultType());
            ks.load(input, password.toCharArray());
            return ks;
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    static byte[] encrypt(X509Certificate certificate, byte[] message) throws GeneralSecurityException {
        Cipher cipher = Cipher.getInstance(certificate.getPublicKey().getAlgorithm());
        cipher.init(Cipher.ENCRYPT_MODE, certificate.getPublicKey());
        return cipher.doFinal(message);
    }

    static byte[] decrypt(PrivateKey privateKey, byte[] data) throws GeneralSecurityException {
        Cipher cipher = Cipher.getInstance(privateKey.getAlgorithm());
        cipher.init(Cipher.DECRYPT_MODE, privateKey);
        return cipher.doFinal(data);
    }

    static byte[] sign(PrivateKey privateKey, X509Certificate certificate, byte[] message)
            throws GeneralSecurityException {
        Signature signature = Signature.getInstance(certificate.getSigAlgName());
        signature.initSign(privateKey);
        signature.update(message);
        return signature.sign();
    }

    static boolean verify(X509Certificate certificate, byte[] message, byte[] sig) throws GeneralSecurityException {
        Signature signature = Signature.getInstance(certificate.getSigAlgName());
        signature.initVerify(certificate);
        signature.update(message);
        return signature.verify(sig);
    }
}
</code></pre>
<p>&#22312;&#19978;&#36848;&#20195;&#30721;&#20013;&#65292;&#25105;&#20204;&#20174;key store&#30452;&#25509;&#35835;&#21462;&#20102;&#31169;&#38053;-&#20844;&#38053;&#23545;&#65292;&#31169;&#38053;&#20197;<code>PrivateKey</code>&#23454;&#20363;&#34920;&#31034;&#65292;&#20844;&#38053;&#20197;<code>X509Certificate</code>&#34920;&#31034;&#65292;&#23454;&#38469;&#19978;&#25968;&#23383;&#35777;&#20070;&#21482;&#21253;&#21547;&#20844;&#38053;&#65292;&#22240;&#27492;&#65292;&#35835;&#21462;&#35777;&#20070;&#24182;&#19981;&#38656;&#35201;&#21475;&#20196;&#65292;&#21482;&#26377;&#35835;&#21462;&#31169;&#38053;&#25165;&#38656;&#35201;&#12290;&#22914;&#26524;&#37096;&#32626;&#21040;Web&#26381;&#21153;&#22120;&#19978;&#65292;&#20363;&#22914;Nginx&#65292;&#38656;&#35201;&#25226;&#31169;&#38053;&#23548;&#20986;&#20026;Private Key&#26684;&#24335;&#65292;&#25226;&#35777;&#20070;&#23548;&#20986;&#20026;X509Certificate&#26684;&#24335;&#12290;</p>
<p>&#20197;HTTPS&#21327;&#35758;&#20026;&#20363;&#65292;&#27983;&#35272;&#22120;&#21644;&#26381;&#21153;&#22120;&#24314;&#31435;&#23433;&#20840;&#36830;&#25509;&#30340;&#27493;&#39588;&#22914;&#19979;&#65306;</p>
<ol>
<li>&#27983;&#35272;&#22120;&#21521;&#26381;&#21153;&#22120;&#21457;&#36215;&#35831;&#27714;&#65292;&#26381;&#21153;&#22120;&#21521;&#27983;&#35272;&#22120;&#21457;&#36865;&#33258;&#24049;&#30340;&#25968;&#23383;&#35777;&#20070;&#65307;</li>
<li>&#27983;&#35272;&#22120;&#29992;&#25805;&#20316;&#31995;&#32479;&#20869;&#32622;&#30340;Root CA&#26469;&#39564;&#35777;&#26381;&#21153;&#22120;&#30340;&#35777;&#20070;&#26159;&#21542;&#26377;&#25928;&#65292;&#22914;&#26524;&#26377;&#25928;&#65292;&#23601;&#20351;&#29992;&#35813;&#35777;&#20070;&#21152;&#23494;&#19968;&#20010;&#38543;&#26426;&#30340;AES&#21475;&#20196;&#24182;&#21457;&#36865;&#32473;&#26381;&#21153;&#22120;&#65307;</li>
<li>&#26381;&#21153;&#22120;&#29992;&#33258;&#24049;&#30340;&#31169;&#38053;&#35299;&#23494;&#33719;&#24471;AES&#21475;&#20196;&#65292;&#24182;&#22312;&#21518;&#32493;&#36890;&#35759;&#20013;&#20351;&#29992;AES&#21152;&#23494;&#12290;</li>
</ol>
<p>&#19978;&#36848;&#27969;&#31243;&#21482;&#26159;&#19968;&#31181;&#26368;&#24120;&#35265;&#30340;&#21333;&#21521;&#39564;&#35777;&#12290;&#22914;&#26524;&#26381;&#21153;&#22120;&#36824;&#35201;&#39564;&#35777;&#23458;&#25143;&#31471;&#65292;&#37027;&#20040;&#23458;&#25143;&#31471;&#20063;&#38656;&#35201;&#25226;&#33258;&#24049;&#30340;&#35777;&#20070;&#21457;&#36865;&#32473;&#26381;&#21153;&#22120;&#39564;&#35777;&#65292;&#36825;&#31181;&#22330;&#26223;&#24120;&#35265;&#20110;&#32593;&#38134;&#31561;&#12290;</p>
<p>&#27880;&#24847;&#65306;&#25968;&#23383;&#35777;&#20070;&#23384;&#20648;&#30340;&#26159;&#20844;&#38053;&#65292;&#20197;&#21450;&#30456;&#20851;&#30340;&#35777;&#20070;&#38142;&#21644;&#31639;&#27861;&#20449;&#24687;&#12290;&#31169;&#38053;&#24517;&#39035;&#20005;&#26684;&#20445;&#23494;&#65292;&#22914;&#26524;&#25968;&#23383;&#35777;&#20070;&#23545;&#24212;&#30340;&#31169;&#38053;&#27844;&#28431;&#65292;&#23601;&#20250;&#36896;&#25104;&#20005;&#37325;&#30340;&#23433;&#20840;&#23041;&#32961;&#12290;&#22914;&#26524;CA&#35777;&#20070;&#30340;&#31169;&#38053;&#27844;&#28431;&#65292;&#37027;&#20040;&#35813;CA&#35777;&#20070;&#31614;&#21457;&#30340;&#25152;&#26377;&#35777;&#20070;&#23558;&#19981;&#21487;&#20449;&#12290;&#25968;&#23383;&#35777;&#20070;&#26381;&#21153;&#21830;<a href="https://en.wikipedia.org/wiki/DigiNotar">DigiNotar</a>&#23601;&#21457;&#29983;&#36807;&#31169;&#38053;&#27844;&#28431;&#23548;&#33268;&#20844;&#21496;&#30772;&#20135;&#30340;&#20107;&#25925;&#12290;</p>
<h3>&#32451;&#20064;</h3>
<p><a href="https://gitee.com/liaoxuefeng/learn-java/raw/master/practices/Java%E6%95%99%E7%A8%8B/120.%E5%8A%A0%E5%AF%86%E4%B8%8E%E5%AE%89%E5%85%A8.1255943717668160/100.%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6.1304227968188450/encrypt-cert.zip">&#20351;&#29992;&#25968;&#23383;&#35777;&#20070;</a></p>
<h3>&#23567;&#32467;</h3>
<p>&#25968;&#23383;&#35777;&#20070;&#23601;&#26159;&#38598;&#21512;&#20102;&#22810;&#31181;&#23494;&#30721;&#23398;&#31639;&#27861;&#65292;&#29992;&#20110;&#23454;&#29616;&#25968;&#25454;&#21152;&#35299;&#23494;&#12289;&#36523;&#20221;&#35748;&#35777;&#12289;&#31614;&#21517;&#31561;&#22810;&#31181;&#21151;&#33021;&#30340;&#19968;&#31181;&#23433;&#20840;&#26631;&#20934;&#12290;</p>
<p>&#25968;&#23383;&#35777;&#20070;&#37319;&#29992;&#38142;&#24335;&#31614;&#21517;&#31649;&#29702;&#65292;&#39030;&#32423;&#30340;Root CA&#35777;&#20070;&#24050;&#20869;&#32622;&#22312;&#25805;&#20316;&#31995;&#32479;&#20013;&#12290;</p>
<p>&#25968;&#23383;&#35777;&#20070;&#23384;&#20648;&#30340;&#26159;&#20844;&#38053;&#65292;&#21487;&#20197;&#23433;&#20840;&#20844;&#24320;&#65292;&#32780;&#31169;&#38053;&#24517;&#39035;&#20005;&#26684;&#20445;&#23494;&#12290;</p>
</div>

    <hr>

    <div class="x-wiki-prev-next uk-clearfix"></div>

    <div class="x-anchor x-comment-anchor"><a name="comments"></a></div>
							</div>
							<div id="x-content-bottom">
								<!-- __snippet__.contentBottom -->
								<div id="sponsor-a" class="uk-margin-bottom"></div>
								<!-- // __snippet__.contentBottom -->
							</div>
							<div id="x-content-comment">
								    <h3>Comments</h3>

    <ul id="x-comment-list" class="uk-comment-list">
    </ul>

    <h3>Make a comment</h3>

    <div class="x-display-if-not-signin">
        <p><button type="button" class="uk-button" onclick="showSignin()"><i class="uk-icon-signin"></i> Sign in to make a comment</button></p>
    </div>

    <div id="x-comment-area"></div>

							</div>
						</div>
											
