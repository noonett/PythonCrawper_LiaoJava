<div class="uk-flex-item-1" style="padding-left:15px; ">
							<div id="x-content-top">
								<!-- __snippet__.contentTop -->
																<!-- // __snippet__.contentTop -->
							</div>
							<div id="x-content">
								    <h4>Hmac&#31639;&#27861;</h4>
    <div class="x-wiki-info">
    	<span>Reads: 20191</span>
    	<a href="/manage/wiki/wikipage_update?id=1305366354722849" target="_blank" class="x-can-edit uk-text-danger">Edit</a>
</div>

    <hr>

    <div class="x-wiki-content x-main-content">
<p>&#22312;&#21069;&#38754;&#35762;&#21040;&#21704;&#24076;&#31639;&#27861;&#26102;&#65292;&#25105;&#20204;&#35828;&#65292;&#23384;&#20648;&#29992;&#25143;&#30340;&#21704;&#24076;&#21475;&#20196;&#26102;&#65292;&#35201;&#21152;&#30416;&#23384;&#20648;&#65292;&#30446;&#30340;&#23601;&#22312;&#20110;&#25269;&#24481;&#24425;&#34425;&#34920;&#25915;&#20987;&#12290;</p>
<p>&#25105;&#20204;&#22238;&#39038;&#19968;&#19979;&#21704;&#24076;&#31639;&#27861;&#65306;</p>
<pre><code>digest = hash(input)
</code></pre>
<p>&#27491;&#26159;&#22240;&#20026;&#30456;&#21516;&#30340;&#36755;&#20837;&#20250;&#20135;&#29983;&#30456;&#21516;&#30340;&#36755;&#20986;&#65292;&#25105;&#20204;&#21152;&#30416;&#30340;&#30446;&#30340;&#23601;&#22312;&#20110;&#65292;&#20351;&#24471;&#36755;&#20837;&#26377;&#25152;&#21464;&#21270;&#65306;</p>
<pre><code>digest = hash(salt + input)
</code></pre>
<p>&#36825;&#20010;salt&#21487;&#20197;&#30475;&#20316;&#26159;&#19968;&#20010;&#39069;&#22806;&#30340;&#8220;&#35748;&#35777;&#30721;&#8221;&#65292;&#21516;&#26679;&#30340;&#36755;&#20837;&#65292;&#19981;&#21516;&#30340;&#35748;&#35777;&#30721;&#65292;&#20250;&#20135;&#29983;&#19981;&#21516;&#30340;&#36755;&#20986;&#12290;&#22240;&#27492;&#65292;&#35201;&#39564;&#35777;&#36755;&#20986;&#30340;&#21704;&#24076;&#65292;&#24517;&#39035;&#21516;&#26102;&#25552;&#20379;&#8220;&#35748;&#35777;&#30721;&#8221;&#12290;</p>
<p>Hmac&#31639;&#27861;&#23601;&#26159;&#19968;&#31181;&#22522;&#20110;&#23494;&#38053;&#30340;&#28040;&#24687;&#35748;&#35777;&#30721;&#31639;&#27861;&#65292;&#23427;&#30340;&#20840;&#31216;&#26159;Hash-based Message Authentication Code&#65292;&#26159;&#19968;&#31181;&#26356;&#23433;&#20840;&#30340;&#28040;&#24687;&#25688;&#35201;&#31639;&#27861;&#12290;</p>
<p>Hmac&#31639;&#27861;&#24635;&#26159;&#21644;&#26576;&#31181;&#21704;&#24076;&#31639;&#27861;&#37197;&#21512;&#36215;&#26469;&#29992;&#30340;&#12290;&#20363;&#22914;&#65292;&#25105;&#20204;&#20351;&#29992;MD5&#31639;&#27861;&#65292;&#23545;&#24212;&#30340;&#23601;&#26159;HmacMD5&#31639;&#27861;&#65292;&#23427;&#30456;&#24403;&#20110;&#8220;&#21152;&#30416;&#8221;&#30340;MD5&#65306;</p>
<pre><code>HmacMD5 &#8776; md5(secure_random_key, input)
</code></pre>
<p>&#22240;&#27492;&#65292;HmacMD5&#21487;&#20197;&#30475;&#20316;&#24102;&#26377;&#19968;&#20010;&#23433;&#20840;&#30340;key&#30340;MD5&#12290;&#20351;&#29992;HmacMD5&#32780;&#19981;&#26159;&#29992;MD5&#21152;salt&#65292;&#26377;&#22914;&#19979;&#22909;&#22788;&#65306;</p>
<ul>
<li>HmacMD5&#20351;&#29992;&#30340;key&#38271;&#24230;&#26159;64&#23383;&#33410;&#65292;&#26356;&#23433;&#20840;&#65307;</li>
<li>Hmac&#26159;&#26631;&#20934;&#31639;&#27861;&#65292;&#21516;&#26679;&#36866;&#29992;&#20110;SHA-1&#31561;&#20854;&#20182;&#21704;&#24076;&#31639;&#27861;&#65307;</li>
<li>Hmac&#36755;&#20986;&#21644;&#21407;&#26377;&#30340;&#21704;&#24076;&#31639;&#27861;&#38271;&#24230;&#19968;&#33268;&#12290;</li>
</ul>
<p>&#21487;&#35265;&#65292;Hmac&#26412;&#36136;&#19978;&#23601;&#26159;&#25226;key&#28151;&#20837;&#25688;&#35201;&#30340;&#31639;&#27861;&#12290;&#39564;&#35777;&#27492;&#21704;&#24076;&#26102;&#65292;&#38500;&#20102;&#21407;&#22987;&#30340;&#36755;&#20837;&#25968;&#25454;&#65292;&#36824;&#35201;&#25552;&#20379;key&#12290;</p>
<p>&#20026;&#20102;&#20445;&#35777;&#23433;&#20840;&#65292;&#25105;&#20204;&#19981;&#20250;&#33258;&#24049;&#25351;&#23450;key&#65292;&#32780;&#26159;&#36890;&#36807;Java&#26631;&#20934;&#24211;&#30340;KeyGenerator&#29983;&#25104;&#19968;&#20010;&#23433;&#20840;&#30340;&#38543;&#26426;&#30340;key&#12290;&#19979;&#38754;&#26159;&#20351;&#29992;HmacMD5&#30340;&#20195;&#30721;&#65306;</p>
<pre><code class="language-x-java">import java.math.BigInteger;
import javax.crypto.*;
----
public class Main {
    public static void main(String[] args) throws Exception {
        KeyGenerator keyGen = KeyGenerator.getInstance("HmacMD5");
        SecretKey key = keyGen.generateKey();
        // &#25171;&#21360;&#38543;&#26426;&#29983;&#25104;&#30340;key:
        byte[] skey = key.getEncoded();
        System.out.println(new BigInteger(1, skey).toString(16));
        Mac mac = Mac.getInstance("HmacMD5");
        mac.init(key);
        mac.update("HelloWorld".getBytes("UTF-8"));
        byte[] result = mac.doFinal();
        System.out.println(new BigInteger(1, result).toString(16));
    }
}
</code></pre>
<p>&#21644;MD5&#30456;&#27604;&#65292;&#20351;&#29992;HmacMD5&#30340;&#27493;&#39588;&#26159;&#65306;</p>
<ol>
<li>&#36890;&#36807;&#21517;&#31216;<code>HmacMD5</code>&#33719;&#21462;<code>KeyGenerator</code>&#23454;&#20363;&#65307;</li>
<li>&#36890;&#36807;<code>KeyGenerator</code>&#21019;&#24314;&#19968;&#20010;<code>SecretKey</code>&#23454;&#20363;&#65307;</li>
<li>&#36890;&#36807;&#21517;&#31216;<code>HmacMD5</code>&#33719;&#21462;<code>Mac</code>&#23454;&#20363;&#65307;</li>
<li>&#29992;<code>SecretKey</code>&#21021;&#22987;&#21270;<code>Mac</code>&#23454;&#20363;&#65307;</li>
<li>&#23545;<code>Mac</code>&#23454;&#20363;&#21453;&#22797;&#35843;&#29992;<code>update(byte[])</code>&#36755;&#20837;&#25968;&#25454;&#65307;</li>
<li>&#35843;&#29992;<code>Mac</code>&#23454;&#20363;&#30340;<code>doFinal()</code>&#33719;&#21462;&#26368;&#32456;&#30340;&#21704;&#24076;&#20540;&#12290;</li>
</ol>
<p>&#25105;&#20204;&#21487;&#20197;&#29992;Hmac&#31639;&#27861;&#21462;&#20195;&#21407;&#26377;&#30340;&#33258;&#23450;&#20041;&#30340;&#21152;&#30416;&#31639;&#27861;&#65292;&#22240;&#27492;&#65292;&#23384;&#20648;&#29992;&#25143;&#21517;&#21644;&#21475;&#20196;&#30340;&#25968;&#25454;&#24211;&#32467;&#26500;&#22914;&#19979;&#65306;</p>
<table>
<thead>
<tr>
<th>username</th>
<th>secret_key (64 bytes)</th>
<th>password</th>
</tr>
</thead>
<tbody>
<tr>
<td>bob</td>
<td>a8c06e05f92e...5e16</td>
<td>7e0387872a57c85ef6dddbaa12f376de</td>
</tr>
<tr>
<td>alice</td>
<td>e6a343693985...f4be</td>
<td>c1f929ac2552642b302e739bc0cdbaac</td>
</tr>
<tr>
<td>tim</td>
<td>f27a973dfdc0...6003</td>
<td>af57651c3a8a73303515804d4af43790</td>
</tr>
</tbody>
</table>
<p>&#26377;&#20102;Hmac&#35745;&#31639;&#30340;&#21704;&#24076;&#21644;<code>SecretKey</code>&#65292;&#25105;&#20204;&#24819;&#35201;&#39564;&#35777;&#24590;&#20040;&#21150;&#65311;&#36825;&#26102;&#65292;<code>SecretKey</code>&#19981;&#33021;&#20174;<code>KeyGenerator</code>&#29983;&#25104;&#65292;&#32780;&#26159;&#20174;&#19968;&#20010;<code>byte[]</code>&#25968;&#32452;&#24674;&#22797;&#65306;</p>
<pre><code class="language-x-java">import java.util.Arrays;
import javax.crypto.*;
import javax.crypto.spec.*;
----
public class Main {
    public static void main(String[] args) throws Exception {
        byte[] hkey = new byte[] { 106, 70, -110, 125, 39, -20, 52, 56, 85, 9, -19, -72, 52, -53, 52, -45, -6, 119, -63,
                30, 20, -83, -28, 77, 98, 109, -32, -76, 121, -106, 0, -74, -107, -114, -45, 104, -104, -8, 2, 121, 6,
                97, -18, -13, -63, -30, -125, -103, -80, -46, 113, -14, 68, 32, -46, 101, -116, -104, -81, -108, 122,
                89, -106, -109 };

        SecretKey key = new SecretKeySpec(hkey, "HmacMD5");
        Mac mac = Mac.getInstance("HmacMD5");
        mac.init(key);
        mac.update("HelloWorld".getBytes("UTF-8"));
        byte[] result = mac.doFinal();
        System.out.println(Arrays.toString(result));
        // [126, 59, 37, 63, 73, 90, 111, -96, -77, 15, 82, -74, 122, -55, -67, 54]
    }
}
</code></pre>
<p>&#24674;&#22797;<code>SecretKey</code>&#30340;&#35821;&#21477;&#23601;&#26159;<code>new SecretKeySpec(hkey, "HmacMD5")</code>&#12290;</p>
<h3>&#23567;&#32467;</h3>
<p>Hmac&#31639;&#27861;&#26159;&#19968;&#31181;&#26631;&#20934;&#30340;&#22522;&#20110;&#23494;&#38053;&#30340;&#21704;&#24076;&#31639;&#27861;&#65292;&#21487;&#20197;&#37197;&#21512;MD5&#12289;SHA-1&#31561;&#21704;&#24076;&#31639;&#27861;&#65292;&#35745;&#31639;&#30340;&#25688;&#35201;&#38271;&#24230;&#21644;&#21407;&#25688;&#35201;&#31639;&#27861;&#38271;&#24230;&#30456;&#21516;&#12290;</p>
</div>

    <hr>

    <div class="x-wiki-prev-next uk-clearfix"></div>

    <div class="x-anchor x-comment-anchor"><a name="comments"></a></div>
							</div>
							<div id="x-content-bottom">
								<!-- __snippet__.contentBottom -->
								<div id="sponsor-a" class="uk-margin-bottom"></div>
								<!-- // __snippet__.contentBottom -->
							</div>
							<div id="x-content-comment">
								    <h3>Comments</h3>

    <ul id="x-comment-list" class="uk-comment-list">
    </ul>

    <h3>Make a comment</h3>

    <div class="x-display-if-not-signin">
        <p><button type="button" class="uk-button" onclick="showSignin()"><i class="uk-icon-signin"></i> Sign in to make a comment</button></p>
    </div>

    <div id="x-comment-area"></div>

							</div>
						</div>
											
